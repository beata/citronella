!function(a){function b(a){return a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'"_+=\/\-]*/g,"")}if(!a.isFunction(a.fn.validate))return null;a.validator.addMethod("checkboxRequired",function(b,c,d){var e=a(c).attr("checkboxRequiredName");return!!a(this.currentForm).find('input:checkbox[name^="'+e+'"]:checked').length},a.validator.format(a.validator.messages.checkboxRequired||"Please select at least {0} option(s)")),a.validator.addMethod("maxWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length<=d},a.validator.format(a.validator.messages.maxWords||"Please enter {0} words or less.")),a.validator.addMethod("minWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length>=d},a.validator.format(a.validator.messages.minWords||"Please enter at least {0} words.")),a.validator.addMethod("rangeWords",function(a,c,d){var e=b(a),f=/\b\w+\b/g;return this.optional(c)||e.match(f).length>=d[0]&&e.match(f).length<=d[1]},a.validator.format(a.validator.messages.rangeWords||"Please enter between {0} and {1} words.")),a.validator.addMethod("letterswithbasicpunc",function(a,b){return this.optional(b)||/^[a-z\-.,()'\"\s]+$/i.test(a)},a.validator.messages.letterswithbasicpunc||"Letters or punctuation only please"),a.validator.addMethod("alphanumeric",function(a,b){return this.optional(b)||/^\w+$/i.test(a)},a.validator.messages.alphanumeric||"Letters, numbers, and underscores only please"),a.validator.addMethod("lettersonly",function(a,b){return this.optional(b)||/^[a-z]+$/i.test(a)},a.validator.messages.lettersonly||"Letters only please"),a.validator.addMethod("nowhitespace",function(a,b){return this.optional(b)||/^\S+$/i.test(a)},a.validator.messages.nowhitespace||"No white space please"),a.validator.addMethod("zipcodeTW",function(a,b){return this.optional(b)||/^\d{3}$|^\d{5}$/.test(a)},a.validator.messages.zipcodeTW||"The specified TW ZIP Code is invalid"),a.validator.addMethod("integer",function(a,b){return this.optional(b)||/^-?\d+$/.test(a)},a.validator.messages.integer||"A positive or negative non-decimal number please"),a.validator.addMethod("time",function(a,b){return this.optional(b)||/^([0-1]\d|2[0-3]):([0-5]\d)$/.test(a)},a.validator.messages.time||"Please enter a valid time, between 00:00 and 23:59"),a.validator.addMethod("time12h",function(a,b){return this.optional(b)||/^((0?[1-9]|1[012])(:[0-5]\d){0,2}(\ [AP]M))$/i.test(a)},a.validator.messages.time12h||"Please enter a valid time, between 00:00 am and 12:00 pm");var c=function(a){return a.length>=9&&a.match(/^(\d{2}-?\d{3,4}-?\d{3,4}|\d{3}-?\d{3}-?\d{3}|\(\d{2}\)\d{3,4}-?\d{3,4}|\(\d{3}\)\d{3}-?\d{3})(\s*#\d+)?$/)},d=function(a){return a.length>=9&&a.match(/^0?9\d{8}$/)};a.validator.addMethod("phoneTW",function(a,b){return a=a.replace(/\s+/g,""),this.optional(b)||c(a)},a.validator.messages.phoneTW||"Please specify a valid phone number"),a.validator.addMethod("mobileTW",function(a,b){return a=a.replace(/\s+|-/g,""),this.optional(b)||d(a)},a.validator.messages.mobileTW||"Please specify a valid mobile number"),a.validator.addMethod("phoneMobileTW",function(a,b){return a=a.replace(/\s+/g,""),this.optional(b)||c(a)||d(a)},a.validator.messages.phoneMobileTW||"Please specify a valid telephone/mobile number"),a.validator.addMethod("taxNumberTW",function(a,b){var c=function(a){if(8!==a.length)return!1;var b=[1,2,1,2,1,2,4,1],c=0,d=0,e=b.length,f=0;for(d=0;e>d;d++)multiply=a.charAt(d)*b[d],c+=Math.floor(multiply/10)+multiply%10;return f=c%10,0===f||9===f&&7===a.charAt(6)};return this.optional(b)||8==a.length&&c(a)},a.validator.messages.taxNumberTW||"Please specify a valid tax number");var e=function(a,b){a=a.toUpperCase();var c=new RegExp(b?"^[A-Z][A-D][0-9]{8}$":"^[A-Z][12][0-9]{8}$");if(!c.test(a))return!1;var d={A:10,B:11,C:12,D:13,E:14,F:15,G:16,H:17,I:34,J:18,K:19,L:20,M:21,N:22,O:35,P:23,Q:24,R:25,S:26,T:27,U:28,V:29,W:32,X:30,Y:31,Z:33},e=0,f=d[a.substr(0,1)];if(e+=Math.floor(f/10)+f%10*9,b){var g=d[a.substr(1,1)];e+=g%10*8}else e+=8*parseInt(a.substr(1,1),10);for(var h=2;8>=h;h++)e+=parseInt(a.substr(h,1),10)*(9-h);return e+=parseInt(a.substr(9,1),10),e%10===0};a.validator.addMethod("idNumberTW",function(a,b){return this.optional(b)||e(a)},a.validator.messages.idNumberTW||"Please specify a valid id number"),a.validator.addMethod("passportNumberTW",function(a,b){var c=function(a){return a.length<=20};return this.optional(b)||c(a.toUpperCase())},a.validator.messages.passportNumberTW||"Please specify a valid passport number"),a.validator.addMethod("arcNumberTW",function(a,b){return this.optional(b)||e(a,!0)},a.validator.messages.arcNumberTW||"Please specify a valid arc number"),a.validator.addMethod("pattern",function(b,c,d){if(this.optional(c))return!0;"string"==typeof d&&(d=new RegExp("^(?:"+d+")$"));var e,f=d.test(b);return!f&&(e=a(c).data("message"))&&(a.validator.messages.pattern=e),f},a.validator.messages.pattern||"Invalid format."),a.validator.addMethod("require_from_group",function(b,c,d){var e=this,f=a.isArray(d)?d:d.split("|"),g=f[1],h=a(g,c.form).filter(function(){return e.elementValue(this)}).length>=parseInt(f[0],10);return h},a.format(a.validator.messages.require_from_group||"Please fill at least {0} of these fields.")),a.validator.addMethod("skip_or_fill_minimum",function(b,c,d){var e=this,f=a.isArray(d)?d:d.split("|");numberRequired=parseInt(f[0],10),selector=f[1];var g=a(selector,c.form).filter(function(){return e.elementValue(this)}).length,h=g>=numberRequired||0===g;return h},a.format(a.validator.messages.skip_or_fill_minimum||"Please either skip these fields or fill at least {0} of them.")),a.validator.addMethod("accept",function(b,c,d){var e,f,g="string"==typeof d?d.replace(/,/g,"|"):"image/*",h=this.optional(c);if(h)return h;if("file"===a(c).attr("type")&&(g=g.replace("*",".*"),c.files&&c.files.length))for(e=0;e<c.files.length;e++)if(f=c.files[e],!f.type.match(new RegExp(".?("+g+")$","i")))return!1;return!0},a.format(a.validator.messages.accept||"Please enter a value with a valid mimetype.")),a.validator.addMethod("extension",function(a,b,c){return c="string"==typeof c?c.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},a.format(a.validator.messages.extension||"Please enter a value with a valid extension."))}(jQuery),function(a){a.isFunction(a.fn.validate)&&(a.validator.setDefaults({onfocusout:function(a){this.element(a)},errorElement:"span",errorClass:"help-block text-danger",errorPlacement:function(a,b){return b.hasClass("ckeditor")?void a.insertAfter(b.parent().children().last()):($target=b.closest(".form-controls"),$target.length?void a.appendTo($target):($target=b.closest(".input-group"),$target.length?void a.insertAfter($target):b.is(":checkbox")&&b.closest("label").length?void a.insertAfter(b.closest("label")):void a.insertAfter(b)))},highlight:function(b){a(b).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(b){var c=a(b),d=c.closest(".form-group");d.find("span.help-block.text-danger:visible").length||d.removeClass("has-error").addClass("has-success")}}),a.validator.mySetupFormValidator=function(b){a(b).filter("[data-validate]").has("textarea.ckeditor").on("submit.validate-ckeditor",function(){a(this).find("textarea.ckeditor").each(function(){CKEDITOR.instances[this.name].updateElement()})}).end().has("[remote]").on("submit.validate-remote",function(){a.ajaxSetup({async:!1}),a(this).find("[remote]").trigger("focusout")}).end().validate()},a.validator.mySetupFormValidator("form"))}(jQuery),function(a){if(window.Handlebars){a("body").on("click","button.js-insert-row, button.insert-row",function(b){var c,d=a(this),e={times:d.data("insertTimes")||1,template:d.data("template"),target:d.data("target"),model:d.data("model"),totalRows:d.data("totalRows"),templateInst:d.data("templateInst"),$target:d.data("$target")},f=e.model||{};e.templateInst||(e.templateInst=Handlebars.compile(a(e.template).html()),d.data("templateInst",e.templateInst)),e.$target||(e.$target=e.target&&a(e.target)||d.parents("table:first").find("tbody"),d.data("$target",e.$target));for(var g=0;g<e.times;g++){c=(d.data("newRows")||0)+1,d.data("newRows",c);var h=a.extend({},f,{id:(new Date).getTime()+""+c,isNew:1,sort:e.totalRows+c});e.$target.append(e.templateInst(h)).find(">:last").trigger("added.insert-row")}e.times&&e.$target.trigger("insert-row.updated"),b.stopPropagation()});var b=a("button.js-insert-row[data-default-list], button.insert-row[data-default-list]");b.length&&b.each(function(){var b=a(this),c=b.data("defaultList")||[];if(c.length){var d,e={$template:b.data("$template"),$target:b.data("$target"),target:b.data("target"),template:b.data("template"),model:b.data("model"),totalRows:b.data("totalRows")},f=e.model||{};e.$template||(e.$template=a(e.template)),e.$target||(e.$target=e.target&&a(e.target)||b.parents("table:first").find("tbody")),a.each(c,function(){d=(b.data("newRows")||0)+1,b.data("newRows",d);var c=a.extend({},f,this);e.$template.mustache(c).appendTo(e.$target)}),c.length&&e.$target.trigger("insert-row.updated")}});var c=a("button.js-insert-row[data-auto-insert], button.insert-row[data-auto-insert]");c.length&&c.each(function(){for(var b=a(this),c=b.data("autoInsert")||1,d=0;c>d;d++)b.trigger("click")})}}(jQuery),function(a){a.ajaxSetup({error:function(b,c,d){var e,f="Request failed: "+c+" "+d;if(b.responseJSON)e=b.responseJSON;else if(b.responseText)try{e=a.parseJSON(b.responseText)}catch(g){}e&&e.error&&(f+="\n"+e.error.message),alert(f)}});var b=a("body").on("change","select[data-go-selected]",function(){var b=a(this),c=b.val();if(c){var d=(b.data("goSelected")||"").replace("_-pageNum-_",c);window.location.href=d}}).on("click","[data-confirm]",function(){var b=a(this);return b.is("[data-confirm-only]")||!b.is("[data-confirm]")||b.parents(b.data("parent")||"form:first").find("input.select:checked").length?confirm(b.data("confirm")||"確定？"):(alert(b.data("selectRequired")||"請選擇項目"),!1)}).on("click","[data-delete-confirm]",function(){var b=a(this);if(b.is("[data-confirm-selected]")&&!b.parents(b.data("parent")||"form:first").find("input.select:checked").length)return alert(b.data("selectRequired")||"請選擇要刪除的項目"),!1;if(!confirm(b.data("deleteConfirm")||"確定要刪除？"))return!1;var c=b.data("deleteUrl");return c?void a.ajax(c,{dataType:"json",data:b.data("deleteData"),type:"POST",async:!1}).done(function(a){return a.error?alert(a.error.message):void(window.location.href=window.location.href)}):!0}).on("click","[data-remove-parent]",function(b){var c=a(this);c.parents(c.data("removeParent")).remove(),b.stopPropagation()}).on("click","[data-dismiss=alert]",function(b){a(this).parents(".alert:first").remove(),b.preventDefault(),b.stopPropagation()}).on("click",'[data-toggle="element"]',function(b){var c=a(this),d=c.data("target"),e=c.data("closest"),f=e&&c.closest(e).find(d)||a(d);if(c.is(":checkbox")){var g=c.prop("checked");c.is("[data-inverse]")&&(g=!g),c.is("[data-clear-checkbox-when-hide]")&&!g&&f.find("input:checkbox").prop("checked",!1),f.toggle(g).trigger(f.is(":hidden")?"hidden":"shown")}else f.toggle().trigger(f.is(":hidden")?"hidden":"shown");c.data("preventDefault")&&b.preventDefault(),b.stopPropagation()}).on("click",'[data-toggle="checkbox"]',function(){var b=a(this),c=b.data("target")||"input.select",d=b.is("[data-checkbox-inverse]")?!this.checked:this.checked;b.parents(b.data("parent")||"form:first").find(c+":not(:disabled)").prop("checked",d)}).on("click",'[data-toggle="buttons-radio"]',function(b){var c,d=a(this),e=d.data("toggleName"),f=a(b.target);return e&&f.is(":button")?(c=d.parents("form:first"),c.find('input[name="'+e+'"]').val(f.val()),"undefined"!=typeof d.data("submitNow")&&c.trigger("submit"),null):null}).on("click","[data-open]",function(){var b=a(this),c=b.data("open"),d=b.data("openParent");(d&&b.parents(d).find(c)||a(c)).show().trigger("shown")}).on("click","[data-close]",function(){var b=a(this),c=b.data("close"),d=b.data("closeParent");(d&&b.parents(d).find(c)||a(c)).hide().trigger("hidden")}).on("change","select[data-submit-now]",function(){return a(this).parents("form:first").trigger("submit"),null}).on("click","[data-submit-now]",function(){var b=a(this);return"SELECT"===this.tagName||"buttons-radio"===b.data("toggle")?null:(b.parents("form:first").trigger("submit"),null)}).on("click","button.btn-switchable",function(b){var c=a(this),d=c.data();return!d.remote||d.busy?null:(c.data("busy",1),a.post(d.remote,d,function(a){return c.data("busy",0),a.error?alert(a.error.message):(c.replaceWith(a.html),null)},"json"),b.stopPropagation(),null)}).on("click","[data-move]",function(){var b=a(this),c=b.data("move"),d=b.data("field")||"sort",e=b.parents(b.data("parent")||"li:first"),f=e["up"===c?"prev":"next"](),g=e.find('input[name$="['+d+']"]'),h=f.find('input[name$="['+d+']"]'),i=g.val(),j=h.val();g.val(j),h.val(i),e["up"===c?"after":"before"](f)}).on("click","[data-history-back]",function(b){b.preventDefault(),window.history.back(a(this).data("historyBack")||-1)}).on("click","[data-open-window]",function(b){var c=a(this);options=c.data(),url=options.url||c.attr("href"),width=options.width||300,height=options.height||300,autofocus=options.focus||!0,leftPos=(a(window).width()-width)/2,topPos=(a(window).height()-height)/2,c.is("a")&&b.preventDefault();var d=window.open(url,options.name||"dialog","menubar=0,toolbar=0,resizable=1,width="+width+",height="+height+",top="+topPos+",left="+leftPos);autofocus&&d.focus()}).on("click","[data-close-window]",function(){window.close()});Modernizr.touch?a("li.hoverswipe").on("swipe",function(b){var c,d=a(this);return"left"===b.direction?(d.trigger("tap.closetarget"),null):"right"!==b.direction?null:(c=d.find(d.data("target")).removeClass("hide").trigger("shown"),d.one("tap.closetarget",function(){c.addClass("hide").trigger("hidden")}),null)}):b.on("mouseenter mouseleave","button.btn-switchable",function(){a(this).toggleClass("btn-switchable-active")}).on("mouseenter mouseleave",'[data-toggle="hover"]',function(b){var c=a(this),d=c.find(c.data("target"));d.toggleClass("hide","mouseleave"===b.type).trigger(d.is(":hidden")?"hidden":"shown")}),a("#listForm").submit(function(){var b=a(this);if(b.is("[data-confirm-selected]")&&!b.find("input.select:checked").length)return alert(b.data("confirmSelected")||"請選擇項目"),!1;var c=b.find("#selActions");if(c.length){var d=c.find('option[value="'+c.val()+'"]').data();if(d&&d.confirm&&!confirm(d.confirm))return!1}b.data("validator")?b.valid()&&b.get(0).submit():b.get(0).submit()});var c=a("#selActions");c.length&&c.change(function(){var a=c.find('option[value="'+c.val()+'"]').data(),b=c.nextAll(".subactions");return b.length&&b.not(".hide").addClass("hide").end(),a?(a.open&&b.filter(a.open).removeClass("hide"),null):null}).trigger("change");var d=a("select.toggle-element");d.length&&d.change(function(){var b=a(this),c=b.find('option[value="'+b.val()+'"]').data();c.open&&a(c.open).removeClass("hide").trigger("shown"),c.close&&a(c.close).addClass("hide").trigger("hidden")})}(jQuery),function(a){var b={CLICK_TOUCH:"click",click_event:"click",init:{}},c={};c.validInput=function(){var b=a(this);b.is("input")||(b=b.find("input:first")),b.valid()},b.init.rangeselect=function(){a("ul.list-checkable").rangeselect({row:"li",checkbox:".select"}),a("table.table").rangeselect({row:"tr",checkbox:".select"})},b.init.tooltip=function(b){a.fn.tooltip&&(b?b.find('[data-rel="tooltip"]'):a('[data-rel="tooltip"]')).tooltip({container:"body"})},b.init.rangeselect(),b.init.tooltip(),a(function(){})}(jQuery,document);
//# sourceMappingURL=admin.min.js.map